
config:
    name: "request methods testcase with functions"
    variables:
        foo1: config_bar1
        foo2: config_bar2
        expect_foo1: config_bar1
        expect_foo2: config_bar2
    base_url: "https://postman-echo.com"
    verify: False
    export: [{
                 "code": "00",
                 "msg": "ok！",
                 "data": {
                     "total": 1,
                     "list": [{
                                  "id": 2843,
                                  "createTime": "2020-11-12 19:49:56",
                                  "modifyTime": null,
                                  "testProcessId": 4350,
                                  "groupName": "",
                                  "coverage_id": "B2020111219495651226",
                                  "app_name": "java_test_01",
                                  "agent_ip": "10.9.16.39",
                                  "branch_name": "rel_test01_1200733",
                                  "code_line_rate": "",
                                  "report_detail": "",
                                  "change_line_rate": "",
                                  "task_status": "1",
                                  "taskDesc": "【测试】乐测精准测试上线第一期",
                                  "test_author": "arkhe",
                                  "precise_task_id": null
                              }],
                     "pageNum": 1,
                     "pageSize": 1,
                     "size": 1,
                     "startRow": 0,
                     "endRow": 0,
                     "pages": 1,
                     "prePage": 0,
                     "nextPage": 0,
                     "isFirstPage": true,
                     "isLastPage": true,
                     "hasPreviousPage": false,
                     "hasNextPage": false,
                     "navigatePages": 8,
                     "navigatepageNums": [1],
                     "navigateFirstPage": 1,
                     "navigateLastPage": 1,
                     "firstPage": 1,
                     "lastPage": 1
                 }
             }]

teststeps:
-
    name: get with params
    variables:
        foo1: bar11
        foo2: bar21
        sum_v: "${add(1, 2)}"
    request:
        method: GET
        url: /get
        params:
            foo1: $foo1
            foo2: $foo2
            sum_v: $sum_v
        headers:
            User-Agent: HttpRunner/${subtract(2,2)}
    extract:
        foo3: "body.args.foo2"
    validate:
        - eq: ["status_code", 200]
        - eq: ["body.args.foo1", "bar11"]
        - eq: ["body.args.sum_v", "3"]
        - eq: ["body.args.foo2", "bar21"]
-
    name: post raw text
    variables:
        foo1: "bar12"
        foo3: "bar32"
    request:
        method: POST
        url: /post
        headers:
            User-Agent: HttpRunner/${subtract(3,2)}
            Content-Type: "text/plain"
        data: "This is expected to be sent back as part of response body: $foo1-$foo2-$foo3."
    validate:
        - eq: ["status_code", 200]
        - eq: ["body.data", "This is expected to be sent back as part of response body: bar12-$expect_foo2-bar32."]
          
-
    name: post form data
    variables:
        foo2: bar23
    request:
        method: POST
        url: /post
        headers:
            User-Agent: HttpRunner/${subtract(3,2)}
            Content-Type: "application/x-www-form-urlencoded"
        data: "foo1=$foo1&foo2=$foo2&foo3=$foo3"
    validate:
        - eq: ["status_code", 200]
        - eq: ["body.form.foo1", "$expect_foo1"]
        - eq: ["body.form.foo2", "bar23"]
        - eq: ["body.form.foo3", "bar21"]
