config:
  name: "获取token信息"
  base_url: "http://127.0.0.1:8000"
  setup_hooks:
    - "${hook(config_setup_hooks1)}"
    - "${hook(config_setup_hooks2)}"
    - "${hook(config_setup_hooks3)}"
    - "${hook(config_setup_hooks4)}"
    - total1: '${add(1, 5)}'
    - total2: '${add(3, 5)}'
  teardown_hooks:
    - "${hook(config_teardown_hooks1)}"
    - "${hook(config_teardown_hooks2)}"
    - "${hook(config_teardown_hooks3)}"
    - "${hook(config_teardown_hooks4)}"
    - total1: '${add(1, 5)}'
    - total2: '${add(3, 5)}'
  variables:
    device_sn: "ABC"
    username: "${hook(config_username)}"
teststeps:
  - name: "请求get-token接口获取token信息"
    variables:
      device_sn: "ABC"
      username: "${hook(USERNAME)}"
      password: "{ENV(PASSWORD)}"
    request:
      url: "/api/get-token"
      method: POST
      headers:
        "device_sn": "10086"
        "username": ${username}
        "os_platform": "Mac OS"
        "app_version": "1.0.0"
      json:
        "sign": "263665175867c416497b99fa461dbe757b2e4d31"
    setup_hooks:
      - "${hook(teststep_setup_hooks1)}"
      - "${hook(teststep_setup_hooks2)}"
      - "${hook(teststep_setup_hooks3)}"
      - "${hook(teststep_setup_hooks4)}"
      - total1: '${add(1, 5)}'
      - total2: '${add(3, 5)}'
    teardown_hooks:
      - "${hook(teststep_teardown_hooks1)}"
      - "${hook(teststep_teardown_hooks2)}"
      - "${hook(teststep_teardown_hooks3)}"
      - "${hook(teststep_teardown_hooks4)}"
      - total1: '${add(1, 5)}'
      - total2: '${add(3, 5)}'
    validate:
      - equalTo: [statusCode, "200"]
      - "check": "statusCode"
        "comparator": "equalTo"
        "expect": "200"
      - "check": "content.code"
        "comparator": "equalTo"
        "expect": "00"
      - "check": "content.message"
        "comparator": "equalTo"
        "expect": "ok！"
